<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" id="theme-meta" content="#1a1a1a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>Shwe Calculator Pro | Premium Edition</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

    <style>
        :root {
            /* Metallic Color Palette */
            --gold-gradient: linear-gradient(135deg, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --gold-soft: #fcc103;
            --diamond-gradient: linear-gradient(135deg, #e0f7fa, #b9f2ff, #ffffff, #b9f2ff, #80deea);
            --diamond-glow: rgba(185, 242, 255, 0.4);
            
            /* Glassmorphism Surface */
            --bg-dark: #0a0a0b;
            --glass-bg: rgba(30, 30, 30, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
            --input-glass: rgba(255, 255, 255, 0.05);
            
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            
            /* Safe Areas */
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        [data-theme="light"] {
            --bg-dark: #f0f2f5;
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(0, 0, 0, 0.1);
            --input-glass: rgba(0, 0, 0, 0.03);
            --text-primary: #1a1a1a;
            --text-secondary: #555555;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at top right, rgba(191, 149, 63, 0.08), transparent),
                              radial-gradient(circle at bottom left, rgba(185, 242, 255, 0.05), transparent);
            color: var(--text-primary);
            margin: 0; padding: 0;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        /* --- PREMIUM HEADER --- */
        header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: calc(15px + var(--safe-top)) 20px 15px;
            display: flex; align-items: center; justify-content: space-between;
            border-bottom: 1px solid var(--glass-border);
            position: sticky; top: 0; z-index: 1000;
        }

        #nav-title {
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* --- GLASS CARDS --- */
        .container {
            padding: 20px;
            max-width: 500px;
            margin: auto;
            padding-bottom: calc(100px + var(--safe-bottom));
        }

        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 24px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        /* Metallic Accent Bar */
        h2 {
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin: 0 0 15px 5px;
            display: flex;
            align-items: center;
            color: var(--text-secondary);
        }

        h2::before {
            content: "";
            width: 4px;
            height: 18px;
            background: var(--gold-gradient);
            margin-right: 12px;
            border-radius: 10px;
        }

        h2.h2-diamond::before {
            background: var(--diamond-gradient);
            box-shadow: 0 0 10px var(--diamond-glow);
        }

        /* --- PREMIUM INPUTS --- */
        label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: block;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 14px 18px;
            background: var(--input-glass);
            border: 1px solid var(--glass-border);
            border-radius: 14px;
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-sizing: border-box;
        }

        input:focus {
            border-color: #bf953f;
            background: rgba(191, 149, 63, 0.05);
            outline: none;
            box-shadow: 0 0 15px rgba(191, 149, 63, 0.2);
        }

        .diamond-focus:focus {
            border-color: #b9f2ff;
            background: rgba(185, 242, 255, 0.05);
            box-shadow: 0 0 15px var(--diamond-glow);
        }

        /* --- GRID & LAYOUT --- */
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

        /* --- BUTTONS --- */
        .btn-main {
            width: 100%;
            padding: 18px;
            background: var(--gold-gradient);
            color: #000;
            border: none;
            border-radius: 18px;
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s, opacity 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 20px rgba(191, 149, 63, 0.3);
        }

        .btn-main:active { transform: scale(0.97); opacity: 0.9; }

        .btn-diamond {
            background: var(--diamond-gradient);
            box-shadow: 0 8px 20px rgba(185, 242, 255, 0.2);
        }

        .btn-reset {
            width: 100%;
            padding: 12px;
            background: transparent;
            color: #ff6b6b;
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 14px;
            margin-top: 15px;
            font-weight: 600;
            cursor: pointer;
        }

        /* --- TABS --- */
        .tab-container {
            background: var(--input-glass);
            padding: 5px;
            border-radius: 16px;
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border: 1px solid var(--glass-border);
        }

        .tab {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: 12px;
            font-weight: 700;
            transition: 0.3s;
        }

        .tab.active {
            background: var(--gold-gradient);
            color: #000;
        }

        /* --- SIDEBAR --- */
        .sidebar {
            height: 100%; width: 0; position: fixed; z-index: 1100; top: 0; left: 0;
            background: var(--bg-dark);
            backdrop-filter: blur(30px);
            overflow-x: hidden; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-right: 1px solid var(--glass-border);
        }

        .sidebar a {
            padding: 18px 25px;
            font-size: 1.1rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--glass-border);
            transition: 0.3s;
        }

        .sidebar a:active { background: var(--input-glass); }

        /* --- RESULTS --- */
        .highlight-box {
            background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0) 100%);
            border: 1px solid var(--glass-border);
            padding: 30px 20px;
            border-radius: 24px;
            text-align: center;
            margin-top: 20px;
        }

        .main-ans {
            font-size: 2.2rem;
            font-weight: 900;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }

        .total-row {
            background: var(--gold-gradient);
            color: #000;
            padding: 20px;
            border-radius: 18px;
            font-size: 1.5rem;
            font-weight: 800;
            margin-top: 20px;
        }

        .res-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--glass-border);
        }

        /* --- THEME TOGGLE --- */
        .theme-toggle {
            width: 44px; height: 44px;
            display: flex; align-items: center; justify-content: center;
            background: var(--input-glass);
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            cursor: pointer;
        }

        .hidden { display: none !important; }

        /* Mobile specific fixes */
        @media (max-width: 370px) {
            .grid-3 { gap: 8px; }
            input { padding: 12px 10px; font-size: 16px; }
            .main-ans { font-size: 1.6rem; }
        }
    </style>
</head>
<body data-theme="dark">

    <div class="app-wrapper">
        <div id="mySidebar" class="sidebar">
            <a href="javascript:void(0)" style="position:absolute; top: calc(10px + var(--safe-top)); right:25px; font-size:35px;" onclick="closeNav()">&times;</a>
            <div style="padding: 30px 25px;"><h3 id="nav-title">·Äõ·ÄΩ·Äæ·Ä±·Äê·ÄΩ·ÄÄ·Ä∫·ÄÖ·ÄÄ·Ä∫ PRO</h3></div>
            <a onclick="showView('price-calc')">üí∞ &nbsp; ·Äõ·ÄΩ·Äæ·Ä±·Äà·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏·Äê·ÄΩ·ÄÄ·Ä∫·Äõ·Äî·Ä∫</a>
            <a onclick="showView('purity-calc')">‚öñÔ∏è &nbsp; ·Ä°·ÄÅ·Ä±·Ä´·ÄÄ·Ä∫·ÄÅ·Äª·ÄΩ·Äê·Ä∫/·Ä°·Äõ·Ää·Ä∫·Äê·ÄΩ·ÄÄ·Ä∫</a>
            <a onclick="showView('diamond-calc')">üíé &nbsp; ·ÄÖ·Ä≠·Äî·Ä∫·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·Äõ·Äê·Äî·Ä¨·Äê·ÄΩ·ÄÄ·Ä∫·Äõ·Äî·Ä∫</a>
            <a onclick="showView('unit-converter')">üîÑ &nbsp; ·Äö·Ä∞·Äî·ÄÖ·Ä∫·Äï·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·Äú·Ä≤·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏</a>
            <a onclick="showView('net-weight')">‚öñÔ∏è &nbsp; ·Ä°·Äû·Ä¨·Ä∏·Äê·ÄÑ·Ä∫·Ä°·Äú·Ä±·Ä∏·ÄÅ·Äª·Ä≠·Äî·Ä∫</a>
            <a onclick="resetAllData()" class="btn-master-reset" style="color:#ff4444; border-top:1px solid #444; margin-top:20px;">‚ö†Ô∏è &nbsp; ·Äí·Ä±·Äê·Ä¨·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏·Äñ·Äª·ÄÄ·Ä∫·Äô·Ää·Ä∫</a>
        </div>
        <div id="overlay" class="overlay" onclick="closeNav()" style="display: none; position: fixed; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 1050; top:0; left:0;"></div>

        <header>
            <div style="display: flex; align-items: center;">
                <span style="font-size:1.5rem; cursor:pointer; margin-right:20px;" onclick="openNav()">&#9776;</span>
                <span id="nav-title">SHWE CALCULATOR PRO</span>
            </div>
            <div class="theme-toggle" onclick="toggleTheme()" id="theme-icon">üåô</div>
        </header>

        <div class="container">
            <div id="price-calc-view">
                <h2>Market Price</h2>
                <div class="card">
                    <label>·Äö·Äî·Ä±·Ä∑·Äï·Ä±·Ä´·ÄÄ·Ä∫·Äà·Ä±·Ä∏ (·ÄÄ·Äª·Äï·Ä∫)</label>
                    <input type="number" id="GoldPrice" inputmode="numeric" placeholder="Enter Price...">
                </div>

                <h2>Gold Weight</h2>
                <div class="card grid-3">
                    <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="PKat" inputmode="numeric"></div>
                    <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="PPe" inputmode="numeric"></div>
                    <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="PYway" inputmode="decimal"></div>
                </div>

                <h2>Wastage / ·Ä°·Äú·Äª·Ä±·Ä¨·Ä∑·Äê·ÄΩ·ÄÄ·Ä∫</h2>
                <div class="card grid-3">
                    <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="RKat" inputmode="numeric"></div>
                    <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="RPae" inputmode="numeric"></div>
                    <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="RYway" inputmode="decimal"></div>
                </div>

                <h2>Craftsmanship & Stones</h2>
                <div class="card">
                    <label>·Äú·ÄÄ·Ä∫·ÄÅ (·ÄÄ·Äª·Äï·Ä∫)</label>
                    <input type="number" id="Smith" inputmode="numeric" style="margin-bottom:20px;">
                    <label>·ÄÄ·Äª·Ä±·Ä¨·ÄÄ·Ä∫·Äñ·Ä≠·ÄØ·Ä∏ (·ÄÄ·Äª·Äï·Ä∫)</label>
                    <input type="number" id="StonePrice" inputmode="numeric">
                </div>
                <button class="btn-main" onclick="calculatePrice()">Calculate Total</button>
                <button class="btn-reset" onclick="resetCalculator()">Reset All Fields</button>
            </div>

            <div id="purity-calc-view" class="hidden">
                <h2>Purity & Yield</h2>
                <div class="tab-container">
                    <button id="tab-purity" class="tab active" onclick="switchPurityTab('purity')">Quality</button>
                    <button id="tab-yield" class="tab" onclick="switchPurityTab('yield')">Yield</button>
                </div>

                <div id="purity-sub-view">
                    <div class="card">
                        <label>·Ä°·Äë·Ää·Ä∫·Äï·Äª·ÄÄ·Ä∫ ·Ä°·Äú·Ä±·Ä∏·ÄÅ·Äª·Ä≠·Äî·Ä∫</label>
                        <div class="grid-3">
                            <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="p1-k" inputmode="numeric"></div>
                            <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="p1-p" inputmode="numeric"></div>
                            <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="p1-y" inputmode="decimal"></div>
                        </div>
                    </div>
                    <div class="card">
                        <label>·ÄÅ·Äª·ÄΩ·Äê·Ä∫·Äï·Äº·ÄÆ·Ä∏·Äõ·Äõ·Äæ·Ä≠·Äû·Ä±·Ä¨ ·Ä°·ÄÅ·Ä±·Ä´·ÄÄ·Ä∫·Äõ·ÄΩ·Äæ·Ä±</label>
                        <div class="grid-3">
                            <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="p2-k" inputmode="numeric"></div>
                            <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="p2-p" inputmode="numeric"></div>
                            <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="p2-y" inputmode="decimal"></div>
                        </div>
                    </div>
                    <button class="btn-main" onclick="calcPurity()">Calculate Purity</button>
                </div>

                <div id="yield-sub-view" class="hidden">
                    <div class="card">
                        <label>·Ä°·Äë·Ää·Ä∫·Äï·Äª·ÄÄ·Ä∫ ·Ä°·Äú·Ä±·Ä∏·ÄÅ·Äª·Ä≠·Äî·Ä∫</label>
                        <div class="grid-3">
                            <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="y1-k" inputmode="numeric"></div>
                            <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="y1-p" inputmode="numeric"></div>
                            <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="y1-y" inputmode="decimal"></div>
                        </div>
                    </div>
                    <div class="card">
                        <label>Density / ·ÄÖ·ÄÄ·Ä∫·Äï·ÄΩ·Ä≠·ÄØ·ÄÑ·Ä∑·Ä∫</label>
                        <input type="number" id="y-den" placeholder="e.g. 17.51" step="0.01">
                        <p style="text-align: center; font-size: 0.8rem; color: var(--text-secondary); margin: 15px 0;">OR</p>
                        <label>·Äï·Ä≤·Äõ·Ää·Ä∫</label>
                        <input type="number" id="y-pe" placeholder="e.g. 14.5">
                    </div>
                    <button class="btn-main" onclick="calcYield()">Calculate Yield</button>
                </div>

                <div id="purity-result" class="highlight-box hidden">
                    <label id="p-res-label" style="color:var(--gold-soft);">Result</label>
                    <div id="p-res-val" class="main-ans">0.00</div>
                    <div id="p-res-detail" style="font-size:0.9rem; color:var(--text-secondary);">-</div>
                </div>
            </div>

            <div id="diamond-calc-view" class="hidden">
                <h2 class="h2-diamond">Diamond Pricing</h2>
                <div class="card">
                    <label>·Äà·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏·Äû·Äê·Ä∫·Äô·Äæ·Äê·Ä∫·ÄÅ·Äª·ÄÄ·Ä∫</label>
                    <select id="DiamondPriceType" style="margin-bottom:20px;" onchange="updateEquivPrice()">
                        <option value="carat">Per Carat (·ÄÄ·Ä¨·Äõ·ÄÄ·Ä∫)</option>
                        <option value="ratti">Per Ratti (·Äõ·Äê·ÄÆ)</option>
                    </select>
                    <label>Rate (·ÄÄ·Äª·Äï·Ä∫)</label>
                    <input type="number" id="DiamondPrice" class="diamond-focus" inputmode="numeric" placeholder="Enter diamond rate..." oninput="updateEquivPrice()">
                    <div id="equivPriceDisplay" style="font-size: 0.8rem; color: #b9f2ff; margin-top: 10px; font-style: italic; opacity: 0.8;"></div>
                </div>

                <h2 class="h2-diamond">Weight (Ct / Ratti)</h2>
                <div class="card">
                    <label>Carat (Ct)</label>
                    <input type="number" id="DCt" class="diamond-focus" inputmode="decimal" placeholder="0.00" oninput="syncDiamondUnits('ct')">
                    <div style="margin-top: 25px; border-top: 1px solid var(--glass-border); padding-top:20px;">
                        <label>Traditional Units (R / B / P)</label>
                        <div class="grid-3">
                            <div class="input-group"><label>R</label><input type="number" id="DR" class="diamond-focus" inputmode="decimal" oninput="syncDiamondUnits('unit')"></div>
                            <div class="input-group"><label>B</label><input type="number" id="DB" class="diamond-focus" inputmode="decimal" oninput="syncDiamondUnits('unit')"></div>
                            <div class="input-group"><label>P</label><input type="number" id="DP" class="diamond-focus" inputmode="decimal" oninput="syncDiamondUnits('unit')"></div>
                        </div>
                    </div>
                </div>
                <button class="btn-main btn-diamond" onclick="calculateDiamondPrice()">Calculate Diamond</button>
                <button class="btn-reset" onclick="resetDiamond()">Reset</button>
            </div>

            <div id="unit-converter-view" class="hidden">
                <h2>Unit Converter</h2>
                <div class="card">
                    <label>Weight in Grams (g)</label>
                    <input type="number" id="gramsInput" inputmode="decimal" placeholder="Enter grams...">
                    <div class="grid-3" style="margin:25px 0;">
                        <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="uKyat" inputmode="numeric"></div>
                        <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="uPe" inputmode="numeric"></div>
                        <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="uYway" inputmode="decimal"></div>
                    </div>
                    <label>Measurement Standard</label>
                    <select id="standard" onchange="convertUnits('grams')">
                        <option value="16.329325">Official (16.3293g)</option>
                        <option value="16.606">Traditional (16.606g)</option>
                    </select>
                </div>

                <div class="highlight-box">
                    <div id="uDisplay" class="main-ans">·ÅÄ ·ÄÄ·Äª·Äï·Ä∫ ·ÅÄ ·Äï·Ä≤ ·ÅÄ ·Äõ·ÄΩ·Ä±·Ä∏</div>
                    <div id="uSubDisplay" style="color:var(--text-secondary); font-size:1rem;">(0.0000 ·ÄÄ·Äª·Äï·Ä∫) | 0.000 g</div>
                </div>
                <button class="btn-reset" onclick="resetConverter()">Reset Converter</button>
            </div>

            <div id="net-weight-view" class="hidden">
                <h2>Gross Weight</h2>
                <div class="card grid-3">
                    <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="TKat" inputmode="numeric" oninput="calculateNetWeight()"></div>
                    <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="TPe" inputmode="numeric" oninput="calculateNetWeight()"></div>
                    <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="TYway" inputmode="decimal" oninput="calculateNetWeight()"></div>
                </div>
                <h2>Subtract Stones</h2>
                <div class="card grid-3">
                    <div class="input-group"><label>·ÄÄ·Äª·Äï·Ä∫</label><input type="number" id="SKat" inputmode="numeric" oninput="calculateNetWeight()"></div>
                    <div class="input-group"><label>·Äï·Ä≤</label><input type="number" id="SPe" inputmode="numeric" oninput="calculateNetWeight()"></div>
                    <div class="input-group"><label>·Äõ·ÄΩ·Ä±·Ä∏</label><input type="number" id="SYway" inputmode="decimal" oninput="calculateNetWeight()"></div>
                </div>
                <div class="highlight-box">
                    <label style="color:var(--gold-soft);">Net Gold Weight</label>
                    <div id="netDisplay" class="main-ans">·ÅÄ ·ÄÄ·Äª·Äï·Ä∫ ·ÅÄ ·Äï·Ä≤ ·ÅÄ ·Äõ·ÄΩ·Ä±·Ä∏</div>
                    <div id="netSubDisplay" style="color:var(--text-secondary); font-size:1rem;">(0.0000 ·ÄÄ·Äª·Äï·Ä∫)</div>
                </div>
            </div>

            <div id="price-result-view" class="hidden">
                <div id="capture-area" class="card" style="padding: 30px 20px;">
                    <h2 id="res-title" style="text-align:center; border:none; justify-content:center; margin-bottom: 25px;">Calculation Receipt</h2>
                    <div id="res-list"></div>
                </div>
                <button class="btn-main" style="background: #2ecc71; color: white; box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3);" onclick="saveAsPhoto()">üì∑ Save to Gallery</button>
                <button id="res-back-btn" class="btn-main" style="background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--glass-border); box-shadow: none;" onclick="showView('price-calc')">Go Back</button>
            </div>
        </div>
    </div>

    <script>
        /* ALL ORIGINAL JAVASCRIPT LOGIC KEPT INTACT */
        // ... (Refer to your original script provided in the file)
        function toggleTheme() {
            const body = document.body;
            const icon = document.getElementById('theme-icon');
            const meta = document.getElementById('theme-meta');
            if (body.getAttribute('data-theme') === 'dark') {
                body.setAttribute('data-theme', 'light');
                icon.innerText = "‚òÄÔ∏è";
                meta.setAttribute('content', '#ffffff');
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.innerText = "üåô";
                meta.setAttribute('content', '#1a1a1a');
                localStorage.setItem('theme', 'dark');
            }
        }

        const inputs = document.querySelectorAll('input, select');
        inputs.forEach(input => {
            input.addEventListener('input', () => { if(input.id) localStorage.setItem(input.id, input.value); });
        });

        window.onload = () => {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-icon').innerText = (savedTheme === 'dark') ? "üåô" : "‚òÄÔ∏è";
            inputs.forEach(input => {
                const savedValue = localStorage.getItem(input.id);
                if (savedValue && input.id) input.value = savedValue;
            });
            calculateNetWeight();
            updateEquivPrice();
        };

        function openNav() { document.getElementById("mySidebar").style.width = "280px"; document.getElementById("overlay").style.display = "block"; }
        function closeNav() { document.getElementById("mySidebar").style.width = "0"; document.getElementById("overlay").style.display = "none"; }

        function showView(view) {
            ['price-calc-view', 'diamond-calc-view', 'unit-converter-view', 'net-weight-view', 'price-result-view', 'purity-calc-view'].forEach(v => {
                const el = document.getElementById(v);
                if(el) el.classList.add('hidden');
            });
            document.getElementById(view + '-view').classList.remove('hidden');
            closeNav();
            window.scrollTo(0,0);
        }

        function switchPurityTab(type) {
            document.getElementById('tab-purity').classList.toggle('active', type === 'purity');
            document.getElementById('tab-yield').classList.toggle('active', type === 'yield');
            document.getElementById('purity-sub-view').classList.toggle('hidden', type !== 'purity');
            document.getElementById('yield-sub-view').classList.toggle('hidden', type !== 'yield');
            document.getElementById('purity-result').classList.add('hidden');
        }

        function toDecimal(k, p, y) { return (parseFloat(k)||0) + ((parseFloat(p)||0)/16) + ((parseFloat(y)||0)/128); }

        function fromDecimal(decimal) {
            let k = Math.floor(decimal + 0.0000001);
            let remPe = (decimal - k) * 16;
            let p = Math.floor(remPe + 0.0000001);
            let y = parseFloat(((remPe - p) * 8).toFixed(2));
            if(y >= 8) { p++; y = 0; }
            if(p >= 16) { k++; p = 0; }
            return `${k} ·ÄÄ·Äª·Äï·Ä∫ ${p} ·Äï·Ä≤ ${y} ·Äõ·ÄΩ·Ä±·Ä∏`;
        }

        function calcPurity() {
            let raw = toDecimal(document.getElementById('p1-k').value, document.getElementById('p1-p').value, document.getElementById('p1-y').value);
            let pure = toDecimal(document.getElementById('p2-k').value, document.getElementById('p2-p').value, document.getElementById('p2-y').value);
            if(raw <= 0 || pure <= 0) return alert("·Ä°·Äú·Ä±·Ä∏·ÄÅ·Äª·Ä≠·Äî·Ä∫·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·ÄÖ·ÄΩ·Ä¨·Äë·Ää·Ä∑·Ä∫·Äï·Ä´·Åã");
            let peYee = (pure / raw) * 16;
            let density = (pure / raw) * 19.32;
            document.getElementById('purity-result').classList.remove('hidden');
            document.getElementById('p-res-label').innerText = "·Äê·ÄΩ·ÄÄ·Ä∫·ÄÅ·Äª·ÄÄ·Ä∫·Äõ·Äõ·Äæ·Ä≠·Äû·Ä±·Ä¨ ·Äõ·ÄΩ·Äæ·Ä±·Ä°·Äõ·Ää·Ä∫·Ä°·Äû·ÄΩ·Ä±·Ä∏";
            document.getElementById('p-res-val').innerText = `${peYee.toFixed(2)} ·Äï·Ä≤·Äõ·Ää·Ä∫`;
            document.getElementById('p-res-detail').innerText = `Density (·ÄÖ·ÄÄ·Ä∫·Äï·ÄΩ·Ä≠·ÄØ·ÄÑ·Ä∑·Ä∫): ${density.toFixed(2)}`;
        }

        function calcYield() {
            let raw = toDecimal(document.getElementById('y1-k').value, document.getElementById('y1-p').value, document.getElementById('y1-y').value);
            let den = parseFloat(document.getElementById('y-den').value);
            let pe = parseFloat(document.getElementById('y-pe').value);
            let resultKyat = 0;
            if(den > 0) resultKyat = (den / 19.32) * raw;
            else if(pe > 0) resultKyat = (pe / 16) * raw;
            else return alert("Density (·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫) ·Äï·Ä≤·Äõ·Ää·Ä∫ ·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·ÄÅ·ÄØ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´·Åã");
            document.getElementById('purity-result').classList.remove('hidden');
            document.getElementById('p-res-label').innerText = "·Äï·Äº·Äî·Ä∫·Äõ·Äô·Ää·Ä∑·Ä∫ ·Ä°·ÄÅ·Ä±·Ä´·ÄÄ·Ä∫·Äõ·ÄΩ·Äæ·Ä±·Äï·Äô·Ä¨·Äè";
            document.getElementById('p-res-val').innerText = fromDecimal(resultKyat);
            document.getElementById('p-res-detail').innerText = `·ÄÖ·ÄØ·ÄÖ·ÄØ·Äï·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äí·Äû·Äô·ÄÄ·Ä≠·Äî·Ä∫·Ä∏: ${resultKyat.toFixed(6)} ·ÄÄ·Äª·Äï·Ä∫`;
        }

        function updateEquivPrice() {
            const price = parseFloat(document.getElementById('DiamondPrice').value) || 0;
            const type = document.getElementById('DiamondPriceType').value;
            const display = document.getElementById('equivPriceDisplay');
            if (price === 0) { display.innerText = ""; return; }
            if (type === 'carat') display.innerText = `‚âà ${Math.round(price / 1.1).toLocaleString()} ·ÄÄ·Äª·Äï·Ä∫ (·ÅÅ ·Äõ·Äê·ÄÆ·Äú·Äª·Äæ·ÄÑ·Ä∫)`;
            else display.innerText = `‚âà ${Math.round(price * 1.1).toLocaleString()} ·ÄÄ·Äª·Äï·Ä∫ (·ÅÅ ·ÄÄ·Ä¨·Äõ·ÄÄ·Ä∫·Äú·Äª·Äæ·ÄÑ·Ä∫)`;
        }

        function syncDiamondUnits(mode) {
            let dr = document.getElementById('DR'), db = document.getElementById('DB'), dp = document.getElementById('DP'), dct = document.getElementById('DCt');
            if (mode === 'ct') {
                const ct = parseFloat(dct.value) || 0;
                const totalRatti = ct * 1.1;
                const r = Math.floor(totalRatti + 0.00001);
                const remB = (totalRatti - r) * 20;
                const b = Math.floor(remB + 0.00001);
                const p = parseFloat(((remB - b) * 8).toFixed(2));
                dr.value = r || ""; db.value = b || ""; dp.value = p > 0 ? p : "";
            } else {
                let r = parseFloat(dr.value) || 0, b = parseFloat(db.value) || 0, p = parseFloat(dp.value) || 0;
                if (p >= 8) { b += Math.floor(p / 8); p = parseFloat((p % 8).toFixed(2)); db.value = b; dp.value = p > 0 ? p : ""; }
                if (b >= 20) { r += Math.floor(b / 20); b = b % 20; dr.value = r; db.value = b > 0 ? b : ""; }
                const totalRatti = r + (b / 20) + (p / 160);
                dct.value = (totalRatti / 1.1).toFixed(4);
            }
        }

        function calculateDiamondPrice() {
            const price = parseFloat(document.getElementById('DiamondPrice').value) || 0;
            const type = document.getElementById('DiamondPriceType').value;
            const ct = parseFloat(document.getElementById('DCt').value) || 0;
            const r = parseFloat(document.getElementById('DR').value) || 0;
            const b = parseFloat(document.getElementById('DB').value) || 0;
            const p = parseFloat(document.getElementById('DP').value) || 0;
            const totalRatti = r + (b / 20) + (p / 160);
            let total = (type === 'carat') ? (ct * price) : (totalRatti * price);
            document.getElementById('res-title').innerText = "Diamond Receipt";
            document.getElementById('res-back-btn').onclick = () => showView('diamond-calc');
            document.getElementById('res-list').innerHTML = `
                <div class="res-row"><span>Rate</span><span style="color:#b9f2ff">${price.toLocaleString()}</span></div>
                <div class="res-row"><span>Weight (Ct)</span><span>${ct} Carat</span></div>
                <div class="res-row"><span>Weight (Ratti)</span><span>${r}R ${b}B ${p}P</span></div>
                <div class="res-row total-row" style="background:var(--diamond-gradient)">
                    <span>TOTAL</span><span>${Math.round(total).toLocaleString()} ·ÄÄ·Äª·Äï·Ä∫</span>
                </div>
            `;
            showView('price-result');
        }

        function calculatePrice() {
            const getVal = (id) => parseFloat(document.getElementById(id).value) || 0;
            const price = getVal('GoldPrice');
            const pk = getVal('PKat'), pp = getVal('PPe'), py = getVal('PYway');
            const rk = getVal('RKat'), rp = getVal('RPae'), ry = getVal('RYway');
            const goldKyat = toDecimal(pk, pp, py);
            const redKyat = toDecimal(rk, rp, ry);
            const smith = getVal('Smith'), stone = getVal('StonePrice');
            const total = (goldKyat * price) + (redKyat * price) + smith + stone;

            document.getElementById('res-title').innerText = "Gold Receipt";
            document.getElementById('res-back-btn').onclick = () => showView('price-calc');
            document.getElementById('res-list').innerHTML = `
                <div class="res-row"><span>Market Price</span><span class="val-highlight">${price.toLocaleString()} ·ÄÄ·Äª·Äï·Ä∫</span></div>
                <div class="res-row"><span>Gold Value</span><span class="val-highlight">${Math.round(goldKyat * price).toLocaleString()}</span></div>
                <div class="res-row"><span>Wastage</span><span class="val-highlight">${Math.round(redKyat * price).toLocaleString()}</span></div>
                <div class="res-row"><span>Craftsmanship</span><span>${(smith + stone).toLocaleString()}</span></div>
                <div class="res-row total-row"><span>TOTAL</span><span>${Math.round(total).toLocaleString()} ·ÄÄ·Äª·Äï·Ä∫</span></div>
            `;
            showView('price-result');
        }

        function calculateNetWeight() {
            const tk = parseFloat(document.getElementById('TKat').value) || 0, tp = parseFloat(document.getElementById('TPe').value) || 0, ty = parseFloat(document.getElementById('TYway').value) || 0;
            const sk = parseFloat(document.getElementById('SKat').value) || 0, sp = parseFloat(document.getElementById('SPe').value) || 0, sy = parseFloat(document.getElementById('SYway').value) || 0;
            const netDec = Math.max(0, toDecimal(tk, tp, ty) - toDecimal(sk, sp, sy));
            document.getElementById('netDisplay').innerText = fromDecimal(netDec);
            document.getElementById('netSubDisplay').innerText = `(${netDec.toFixed(4)} ·ÄÄ·Äª·Äï·Ä∫)`;
        }

        function convertUnits(source) {
            const factor = parseFloat(document.getElementById('standard').value);
            let kyatDec = (source === 'grams') ? (parseFloat(document.getElementById('gramsInput').value) || 0) / factor : toDecimal(document.getElementById('uKyat').value, document.getElementById('uPe').value, document.getElementById('uYway').value);
            document.getElementById('uDisplay').innerText = fromDecimal(kyatDec);
            document.getElementById('uSubDisplay').innerText = `(${kyatDec.toFixed(4)} ·ÄÄ·Äª·Äï·Ä∫) | ${(kyatDec * factor).toFixed(3)} g`;
            if (source === 'grams') {
                let parts = fromDecimal(kyatDec).match(/\d+(\.\d+)?/g);
                document.getElementById('uKyat').value = parts[0]; document.getElementById('uPe').value = parts[1]; document.getElementById('uYway').value = parts[2];
            } else document.getElementById('gramsInput').value = (kyatDec * factor).toFixed(3);
        }

        function resetAllData() {
            if (confirm("Clear all data permanently?")) {
                document.querySelectorAll('input').forEach(i => i.value = "");
                localStorage.clear();
                location.reload();
            }
        }
        function resetCalculator() { document.querySelectorAll('#price-calc-view input').forEach(i => i.value = ""); }
        function resetDiamond() { document.querySelectorAll('#diamond-calc-view input').forEach(i => i.value = ""); updateEquivPrice(); }
        function resetConverter() { document.querySelectorAll('#unit-converter-view input').forEach(i => i.value = ""); }
        
        function saveAsPhoto() {
            html2canvas(document.getElementById("capture-area"), { 
                backgroundColor: getComputedStyle(document.body).getPropertyValue('--bg-dark'), 
                scale: 3,
                borderRadius: 24
            }).then(canvas => {
                const link = document.createElement('a'); 
                link.download = `ShwePro_${Date.now()}.png`; 
                link.href = canvas.toDataURL("image/png"); 
                link.click();
            });
        }
    </script>
</body>
</html>
